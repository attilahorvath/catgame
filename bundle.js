!function(){"use strict";class t extends Float32Array{static projection(e,i){return new t([2/e,0,0,0,-2/i,0,-1,1,1])}}class e{#t;#e;#i;#s;constructor(t,e,i){const s=this.#r(t,t.VERTEX_SHADER,e),r=this.#r(t,t.FRAGMENT_SHADER,i);this.#t=t.createProgram(),t.attachShader(this.#t,s),t.attachShader(this.#t,r),t.bindAttribLocation(this.#t,0,"vertexPosition"),t.bindAttribLocation(this.#t,1,"vertexColor"),t.bindAttribLocation(this.#t,2,"vertexTexCoord"),t.bindAttribLocation(this.#t,3,"spritePosition"),t.bindAttribLocation(this.#t,4,"spriteSize"),t.bindAttribLocation(this.#t,5,"spriteType"),t.bindAttribLocation(this.#t,6,"spriteColor"),t.bindAttribLocation(this.#t,7,"spriteAngle"),t.linkProgram(this.#t),this.#e=t.getUniformLocation(this.#t,"projection"),this.#i=t.getUniformLocation(this.#t,"tex"),this.#s=t.getUniformLocation(this.#t,"imageSize"),console.log(t.getProgramInfoLog(this.#t))}use(t,e){t.useProgram(this.#t),this.setUniforms(t,e)}setUniforms(t,e){null!=this.#e&&t.uniformMatrix3fv(this.#e,!1,e),null!=this.#i&&t.uniform1i(this.#i,0),null!=this.#s&&t.uniform1f(this.#s,this.imageSize)}#r(t,e,i){const s=t.createShader(e);return t.shaderSource(s,i),t.compileShader(s),console.log(t.getShaderInfoLog(s)),s}}class i{#h;#a;#n;#o;#l;#g;#c;#d;constructor(){this.canvas=document.createElement("canvas"),this.canvas.width=800,this.canvas.height=600,this.canvas.style.cursor="none",this.canvas.style.touchAction="none",document.body.appendChild(this.canvas),this.#h=this.canvas.getContext("webgl2"),this.#h.viewport(0,0,800,600),this.#h.clearColor(.68,.68,.94,1),this.#h.enable(this.#h.BLEND),this.#h.blendFunc(this.#h.SRC_ALPHA,this.#h.ONE_MINUS_SRC_ALPHA),this.quadBuffer=this.#m(),this.#a=new Map,this.#n=new Map,this.#o=[],this.#l=t.projection(800,600)}createShader(t,i,s){const r=this.#a.get(t);if(r)return r;const h=new e(this.#h,i,s);return this.#a.set(t,h),h}createVao(){const t=this.#h.createVertexArray();return this.#h.bindVertexArray(t),t}createBuffer(t,e){const i=this.#h.createBuffer();return this.updateBuffer(i,t,e),i}updateBuffer(t,e,i){this.useBuffer(t),this.#h.bufferData(this.#h.ARRAY_BUFFER,e,i?this.#h.DYNAMIC_DRAW:this.#h.STATIC_DRAW)}useBuffer(t){this.#h.bindBuffer(this.#h.ARRAY_BUFFER,t)}setAttribute(t,e,i,s,r){this.#h.vertexAttribPointer(t,e,this.#h.FLOAT,!1,i,s),this.#h.enableVertexAttribArray(t),null!=r&&this.#h.vertexAttribDivisor(t,r)}loadTexture(t,e){const i=this.#n.get(t);if(i)return i;const s=this.#h.createTexture();this.#u(s,null,e);const r=this.#o.length,h=new Image;return h.src=t,h.onload=()=>this.#u(s,r,e),this.#n.set(t,s),this.#o[r]=h,s}clear(){this.#h.clear(this.#h.COLOR_BUFFER_BIT|this.#h.DEPTH_BUFFER_BIT)}draw(t,e,i,s,r){t!==this.#g?(t.use(this.#h,this.#l),this.#g=t):this.#g.setUniforms(this.#h,this.#l),e!==this.#c&&(this.#h.bindVertexArray(e),this.#c=e),i!==this.#d&&(this.#h.activeTexture(this.#h.TEXTURE0),this.#h.bindTexture(this.#h.TEXTURE_2D,i),this.#d=i),null!=r?this.#h.drawArraysInstanced(this.#h.TRIANGLES,0,s,r):this.#h.drawArrays(this.#h.TRIANGLES,0,s)}#m(){return this.createBuffer(new Float32Array([0,0,0,0,0,1,0,1,1,0,1,0,1,0,1,0,0,1,0,1,1,1,1,1]),!1)}#u(t,e,i){this.#h.activeTexture(this.#h.TEXTURE0),this.#h.bindTexture(this.#h.TEXTURE_2D,t),this.#h.pixelStorei(this.#h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),null!=e?this.#h.texImage2D(this.#h.TEXTURE_2D,0,this.#h.RGBA,this.#h.RGBA,this.#h.UNSIGNED_BYTE,this.#o[e]):this.#h.texImage2D(this.#h.TEXTURE_2D,0,this.#h.RGBA,1,1,0,this.#h.RGBA,this.#h.UNSIGNED_BYTE,new Uint8Array([255,0,255,255])),this.#h.texParameteri(this.#h.TEXTURE_2D,this.#h.TEXTURE_WRAP_S,this.#h.CLAMP_TO_EDGE),this.#h.texParameteri(this.#h.TEXTURE_2D,this.#h.TEXTURE_WRAP_T,this.#h.CLAMP_TO_EDGE),this.#h.texParameteri(this.#h.TEXTURE_2D,this.#h.TEXTURE_MIN_FILTER,i?this.#h.LINEAR:this.#h.NEAREST),this.#h.texParameteri(this.#h.TEXTURE_2D,this.#h.TEXTURE_MAG_FILTER,i?this.#h.LINEAR:this.#h.NEAREST)}}class s{#p;#f;#b;#w;#x;#v;constructor(t){this.#p={},this.#f={},t.renderer.canvas.addEventListener("pointermove",t=>{this.x=t.offsetX,this.y=t.offsetY}),t.renderer.canvas.addEventListener("pointerdown",t=>{this.x=t.offsetX,this.y=t.offsetY,this.#b=!0}),t.renderer.canvas.addEventListener("pointerup",t=>{this.x=t.offsetX,this.y=t.offsetY,this.#w=!0}),addEventListener("keydown",t=>{this.#p[t.code]=!0}),addEventListener("keyup",t=>{this.#f[t.code]=!0})}update(){this.x===this.#x&&this.y===this.#v||(this.#x=this.x,this.#v=this.y,this.moved=!0),this.press=!1,this.#b&&(this.press=!0,this.#b=!1),this.release=!1,this.#w&&(this.release=!0,this.#w=!1),this.keyPresses={};for(const[t,e]of Object.entries(this.#p))e&&(this.keyPresses[t]=!0,this.#p[t]=!1);this.keyReleases={};for(const[t,e]of Object.entries(this.#f))e&&(this.keyReleases[t]=!0,this.#f[t]=!1)}}class r{constructor(t,e,i,s,r){this.x=t,this.y=e,this.size=i,this.type=s,this.angle=0,this.enabled=!0,this.hidden=!1,this.a=1,this.setColor(r)}attributes(){return[this.x,this.y,this.size,this.type,this.r,this.g,this.b,this.a,this.angle]}setBaseColor(t){this.baseColor=t,this.setColor(t)}setColor(t){switch(t){case"primary":this.r=.85,this.g=.86,this.b=1;break;case"background":this.r=.68,this.g=.68,this.b=.94;case"highlight":this.r=.76,this.g=.55,this.b=.58;break;case"active":this.r=.65,this.g=.4,this.b=.44;break;case"inactive":this.r=.34,this.g=.34,this.b=.46;break;case"blackcat":this.r=.33,this.g=.33,this.b=.33;break;case"orangecat":this.r=.7,this.g=.45,this.b=.08;break;case"primary1":this.#A(144,168,195);break;case"primary2":this.#A(70,157,137);break;case"primary3":this.#A(181,201,154);break;case"primary4":this.#A(0,166,251);break;case"primary5":this.#A(76,201,240);break;case"primary6":this.#A(244,202,224);break;case"primary7":this.#A(229,0,164);break;case"primary8":this.#A(242,0,137);break;case"primary9":this.#A(255,255,255);break;case"primary10":this.r=1,this.g=.8,this.b=.94;break;case"inactive1":this.#A(144,168,195);break;case"inactive2":this.#A(70,157,137);break;case"inactive3":this.#A(181,201,154);break;case"inactive4":this.#A(0,166,251);break;case"inactive5":this.#A(76,201,240);break;case"inactive6":this.#A(244,202,224);break;case"inactive7":this.#A(229,0,164);break;case"inactive8":this.#A(242,0,137);break;case"inactive9":this.#A(255,255,255);break;case"inactive10":this.r=1,this.g=.8,this.b=.94;break;default:this.r=1,this.g=1,this.b=1}}activate(t){this.inactive=!t,this.setColor(t?this.baseColor||"primary":"inactive")}write(t,e,i,s="active"){(this.content||{}).enabled=!1,this.content=t.write(e.toString(),this.x+(this.size-i)/2,this.y+(this.size-i)/2,i,s)}#A(t,e,i){this.r=t/255,this.g=e/255,this.b=i/255}}class h{#y;#R;#B;#T;#E;#S;#k;constructor(t,e,i,s){this.#y=t,this.#R=i,this.#B=this.#y.renderer.createShader("sprite","#version 300 es\nuniform mat3 projection;uniform float imageSize;uniform sampler2D tex;in vec2 vertexPosition;in vec2 vertexTexCoord;in vec2 spritePosition;in float spriteSize;in float spriteType;in vec4 spriteColor;in float spriteAngle;out vec2 texCoord;out vec4 tint;void main(){vec2 texOffset=vec2(imageSize/float(textureSize(tex,0)),imageSize/float(textureSize(tex,0).y));texCoord=vec2(texOffset.x,0.0)*spriteType+vertexTexCoord*texOffset;tint=spriteColor;gl_Position=vec4(projection*vec3(vertexPosition*spriteSize+spritePosition,1.0),1.0);}","#version 300 es\nprecision highp float;uniform sampler2D tex;in vec2 texCoord;in vec4 tint;out vec4 fragmentColor;void main(){fragmentColor=texture(tex,texCoord)*tint;}"),this.#T=this.#y.renderer.createVao(),this.#y.renderer.useBuffer(this.#y.renderer.quadBuffer),this.#y.renderer.setAttribute(0,2,16,0),this.#y.renderer.setAttribute(2,2,16,8),this.#E=this.#y.renderer.createBuffer(new Float32Array,!0),this.#y.renderer.setAttribute(3,2,36,0,1),this.#y.renderer.setAttribute(4,1,36,8,1),this.#y.renderer.setAttribute(5,1,36,12,1),this.#y.renderer.setAttribute(6,4,36,16,1),this.#y.renderer.setAttribute(7,1,36,32,1),this.#S=this.#y.renderer.loadTexture(e,s),this.sprites=[],this.changed()}addSprite(t,e,i,s,h){const a=new r(t,e,i,s,h);return this.sprites.push(a),this.changed(),a}changed(){this.#k=!0}update(){this.#k&&(this.sprites=this.sprites.filter(t=>t.enabled),this.#y.renderer.updateBuffer(this.#E,new Float32Array(this.sprites.filter(t=>t.enabled&&!t.hidden).map(t=>t.attributes()).flat()),!0),this.#k=!1)}draw(){this.#B.imageSize=this.#R,this.#y.renderer.draw(this.#B,this.#T,this.#S,6,this.sprites.length)}}class a{constructor(t,e,i,s,r){this.text=t,this.x=e,this.y=i,this.size=s,this.color=r,this.sprites=[],this.enabled=!0}}class n extends h{#C;constructor(t){super(t,"textures/font.png",16),this.#C=[]}write(t,e,i,s,r="active"){const h=new a(t,e,i,s,r);let n=e,o=i;for(const i of t){let t;"\n"!==i?(i>="A"&&i<="Z"?t=i.charCodeAt(0)-"A".charCodeAt(0):i>="0"&&i<="9"&&(t=26+i.charCodeAt(0)-"0".charCodeAt(0)),null!=t&&h.sprites.push(this.addSprite(n,o,s,t,r)),n+=s):(o+=s,n=e)}return this.#C.push(h),this.changed(),h}clear(){for(const t of this.#C)for(const e of t.sprites)e.enabled=!1;this.#C=[],this.changed()}update(){for(const t of this.#C.filter(t=>!t.enabled))for(const e of t.sprites)e.enabled=!1;this.#C=this.#C.filter(t=>t.enabled),super.update()}}class o extends h{#y;#P;#L;#X;#M;#U;#G;#_;constructor(t,e,i,s,r,h,a,n,o,l="primary"){super(t,"textures/cells.png",16,!0),this.#y=t,this.x=e,this.y=i,this.width=s,this.height=r,this.#P=h,this.#L=a??0,this.#X=n??0,this.#M=o,this.#U=l;for(let t=0;t<r;t++)for(let e=0;e<s;e++){const i=this.addSprite(this.x+e*this.#D,this.y+t*this.#z,this.#P,0,l);i.setColor(l),i.gridX=e,i.gridY=t}}update(){if(!this.disabled){if(this.#y.input.moved){let t=this.#O(this.#y.input.x,this.#y.input.y);t?.inactive&&(t=null),t===this.#G||this.#_||(this.onactivate||this.#M)&&(this.#G?.inactive||this.#G?.setColor(this.#G?.baseColor||this.#U),t?.setColor("highlight"),this.changed()),this.#G=t}this.#y.input.press&&(this.#_=this.#G,(this.onpress||this.#M)&&(this.#_?.setColor("active"),this.changed())),this.#y.input.release&&(this.#M&&(this.#_?.setColor(this.#_?.baseColor||this.#U),this.#M(this.#G===this.#_?this.#_:null,this.#_),this.changed()),this.#_=null)}super.update()}cellAt(t,e){if(t>=0&&t<this.width&&e>=0&&e<this.height)return this.sprites[this.width*e+t]}#O(t,e){const i=this.#I(t,e);if(i)return this.cellAt(i[0],i[1])}#I(t,e){const i=t-this.x,s=e-this.y,r=Math.trunc(i/this.#D),h=Math.trunc(s/this.#z);if(i>=0&&s>=0&&i-r*this.#D<this.#P&&s-h*this.#z<this.#P&&r>=0&&r<this.width&&h>=0&&h<this.height)return[r,h]}get#D(){return this.#P+this.#L}get#z(){return this.#P+this.#X}}class l{#y;#F;#Y;#N;#K;#j;constructor(t,e){this.#y=t,this.#F=e,this.#N=new o(this.#y,750,10,1,1,32,0,0,t=>this.#W(t)),this.#K=this.#N.sprites[0],this.#H()}update(){return this.#j?(this.#y.text.clear(),this.#K.content.enabled=!1,new p(this.#y)):(this.#Y.update(),this.#N.update(),this)}draw(){this.#Y.draw(),this.#N.draw()}#H(){this.#y.text.clear(),this.#Y=new this.#F(this.#y,()=>this.#V(),()=>this.#$()),this.#K=this.#N.sprites[0],this.#K.write(this.#y.text,"X",24,"active")}#V(){this.#y.scheduleTimer(500,()=>{alert("win"),this.#j=!0})}#$(){this.#y.scheduleTimer(500,()=>{this.#H()})}#W(t){t===this.#K&&(this.#j=!0)}}class g{#y;#q;#Q;#Z;#N;#J;#tt;#et;#it;constructor(t,e,i){this.#y=t,this.#q=e,this.#Q=i,this.#Z=new o(this.#y,100,150,10,10,32,4,4,t=>this.#st(t)),this.#N=new o(this.#y,10,10,2,1,32,10,0,t=>this.#W(t)),this.#J=this.#N.cellAt(0,0),this.#J.write(this.#y.text,"O",30,"active"),this.#tt=this.#N.cellAt(1,0),this.#tt.write(this.#y.text,"X",30,"active"),this.#rt("dig"),this.#y.text.write("MEOWSWEEPER",50,50,32,"inactive")}update(){(this.#y.input.keyPresses.KeyA||this.#y.input.keyPresses.ArrowLeft)&&this.#rt("dig"),(this.#y.input.keyPresses.KeyD||this.#y.input.keyPresses.ArrowRight)&&this.#rt("flag"),this.#Z.update(),this.#N.update()}draw(){this.#Z.draw(),this.#N.draw()}#st(t){if(t)switch(this.#et){case"dig":this.#it||this.#ht(t),this.#at(t.gridX,t.gridY),t.mine&&(this.#Z.disabled=!0,this.#y.scheduleTimer(2e3,()=>{for(const t of this.#Z.sprites)(t.content||{}).enabled=!1;this.#y.text.changed(),this.#Q&&this.#Q()}));break;case"flag":t.flagged?(t.flagged=!1,t.content.enabled=!1,this.#y.text.changed()):(t.flagged=!0,t.write(this.#y.text,"X",26,"highlight"))}}#ht(t){const e=this.#Z.sprites.filter(e=>e!==t&&(Math.abs(e.gridX-t.gridX)>1||Math.abs(e.gridY-t.gridY)>1));for(let t=0;t<10;t++){const t=Math.floor(Math.random()*e.length),i=e[t];e.splice(t,1),i.mine=!0}for(let t=0;t<this.#Z.height;t++)for(let e=0;e<this.#Z.width;e++){let i=this.#Z.cellAt(e,t);if(!i.mine){i.mines=0;for(let s=-1;s<=1;s++)for(let r=-1;r<=1;r++)this.#Z.cellAt(e+r,t+s)?.mine&&(i.mines+=1)}}this.#it=!0}#at(t,e){const i=this.#Z.cellAt(t,e);if(i?.flagged&&(i.flagged=!1,i.content.enabled=!1),i?.enabled&&!i?.opened)if(i.opened=!0,i.activate(!1),0===i.mines)i.hidden=!0,this.#at(t,e-1),this.#at(t,e+1),this.#at(t-1,e),this.#at(t+1,e);else if(i.mine)for(const t of this.#Z.sprites.filter(t=>t.mine))t.activate(!1),t.write(this.#y.text,"X",26,"inactive10");else i.write(this.#y.text,i.mines,26,`inactive${i.mines}`);this.#Z.sprites.filter(t=>!t.opened).every(t=>t.mine)&&this.#q&&this.#q()}#W(t){t===this.#tt?this.#rt("flag"):t===this.#J&&this.#rt("dig")}#rt(t){this.#et=t,this.#J.activate("dig"!==this.#et),this.#tt.activate("flag"!==this.#et),this.#N.changed()}}class c{#y;#q;#Q;#Z;#nt;#ot;constructor(t,e,i){this.#y=t,this.#q=e,this.#Q=i,this.#Z=new o(this.#y,100,150,3,3,64,20,20,t=>this.#st(t))}update(){this.#Z.update()}draw(){this.#Z.draw()}#st(t){t&&!t.symbol&&(this.#lt(t,"X"),this.#Z.disabled=!0,this.#nt=this.#y.scheduleTimer(1e3,()=>{if(!this.#ot){const t=this.#Z.sprites.filter(t=>!t.symbol);t.length>0&&(this.#lt(t[Math.floor(Math.random()*t.length)],"O"),this.#Z.disabled=!1,this.#Z.changed())}}))}#lt(t,e){this.#ot||(t.symbol=e,t.activate(!1),t.write(this.#y.text,e,16,"highlight"),this.#gt())}#gt(){for(let t=0;t<3;t++){const e=new Map;for(let i=0;i<3;i++){const s=this.#Z.cellAt(i,t);e.set(s.symbol,(e.get(s.symbol)||0)+1)}if(3===e.get("X"))return this.#V("X");if(3===e.get("O"))return this.#V("O")}for(let t=0;t<3;t++){const e=new Map;for(let i=0;i<3;i++){const s=this.#Z.cellAt(t,i);e.set(s.symbol,(e.get(s.symbol)||0)+1)}if(3===e.get("X"))return this.#V("X");if(3===e.get("O"))return this.#V("O")}return"X"===this.#Z.cellAt(0,0).symbol&&"X"===this.#Z.cellAt(1,1).symbol&&"X"===this.#Z.cellAt(2,2).symbol?this.#V("X"):"O"===this.#Z.cellAt(0,0).symbol&&"O"===this.#Z.cellAt(1,1).symbol&&"O"===this.#Z.cellAt(2,2).symbol?this.#V("O"):"X"===this.#Z.cellAt(2,0).symbol&&"X"===this.#Z.cellAt(1,1).symbol&&"X"===this.#Z.cellAt(0,2).symbol?this.#V("X"):"O"===this.#Z.cellAt(2,0).symbol&&"O"===this.#Z.cellAt(1,1).symbol&&"O"===this.#Z.cellAt(0,2).symbol?this.#V("O"):void 0}#V(t){this.#ot=!0,this.#Z.disabled=!0,(this.#nt||{}).disabled=!0,"X"===t?this.#q&&this.#q():"O"===t&&this.#Q&&this.#Q()}}class d{#y;#q;#ct;#N;#dt;constructor(t,e){this.#y=t,this.#q=e,this.#ct=[];for(let t=0;t<3;t++)for(let e=0;e<3;e++){const i=new o(this.#y,100+100*e,100+100*t,3,3,24,5,5,t=>this.#st(t));this.#ct.push(i)}this.#N=new o(this.#y,10,10,10,1,32,10,0,t=>this.#W(t));for(let t=1;t<=10;t++){const e=this.#N.sprites[t-1];e.write(this.#y.text,t<=9?t:"X",30,t<=9?`inactive${t}`:"active"),e.digit=t<=9?t:null}this.#mt(),this.#ut(1)}update(){for(let t=1;t<=9;t++)this.#y.input.keyPresses[`Digit${t}`]&&this.#ut(t);(this.#y.input.keyPresses.KeyA||this.#y.input.keyPresses.ArrowLeft)&&this.#dt>1&&this.#ut(this.#dt-1),(this.#y.input.keyPresses.KeyD||this.#y.input.keyPresses.ArrowRight)&&this.#dt<9&&this.#ut(this.#dt+1),(this.#y.input.keyPresses.KeyX||this.#y.input.keyPresses.Digit0)&&this.#ut(null);for(const t of this.#ct)t.update();this.#N.update()}draw(){for(const t of this.#ct)t.draw();this.#N.draw()}#pt(t,e){return this.#ct[3*Math.floor(e/3)+Math.floor(t/3)]}#ft(t,e){return this.#pt(t,e).cellAt(t%3,e%3)}#mt(){const t=[[6,8,0,1,0,0,0,9,0,0,3,4,5,0,8,0,2,0,2,1,0,0,6,0,3,0,0,5,0,0,4,0,7,0,0,9,3,4,2,9,0,0,0,0,6,0,0,7,0,8,0,5,0,0,9,2,0,8,0,0,0,5,3,0,0,3,2,0,0,9,1,8,0,0,0,3,0,0,0,6,7]],e=t[Math.floor(Math.random()*t.length)];for(let t=0;t<9;t++)for(let i=0;i<9;i++){const s=e[9*t+i];if(0!==s){const e=this.#ft(i,t);e.activate(!1),e.digit=s,e.write(this.#y.text,s,20,`inactive${s}`)}}}#st(t){t&&(t.digit=this.#dt,(t.content||{}).enabled=!1,this.#dt&&t.write(this.#y.text,this.#dt,20,`inactive${this.#dt}`),this.#bt()&&this.#q&&this.#q(),this.#y.text.changed())}#bt(){let t=!0;this.#wt();for(let e=0;e<9;e++)t&=this.#xt(e),t&=this.#vt(e),t&=this.#gt(e);return t}#wt(){for(let t=0;t<9;t++)for(let e=0;e<9;e++){const i=this.#ft(e,t);i.inactive||i.setBaseColor("primary")}for(let t=0;t<9;t++)this.#ct[t].changed()}#xt(t){let e=!0;const i=new Map;for(let e=0;e<9;e++){const s=this.#ft(t,e);i.set(s.digit,(i.get(s.digit)||0)+1)}for(const[s,r]of i.entries())if(null==s)e=!1;else if(r>1){e=!1;for(let e=0;e<9;e++){const i=this.#ft(t,e);i.inactive||i.digit!=s||(i.setBaseColor("active"),this.#pt(t,e).changed())}}return e}#vt(t){let e=!0;const i=new Map;for(let e=0;e<9;e++){const s=this.#ft(e,t);i.set(s.digit,(i.get(s.digit)||0)+1)}for(const[s,r]of i.entries())if(null==s)e=!1;else if(r>1){e=!1;for(let e=0;e<9;e++){const i=this.#ft(e,t);i.inactive||i.digit!=s||(i.setBaseColor("active"),this.#pt(e,t).changed())}}return e}#gt(t){let e=!0;const i=new Map,s=this.#ct[t];for(let t=0;t<9;t++){const e=s.sprites[t];i.set(e.digit,(i.get(e.digit)||0)+1)}for(const[t,r]of i.entries())if(null==t)e=!1;else if(r>1){e=!1;for(let e=0;e<9;e++){const i=s.sprites[e];i.inactive||i.digit!=t||(i.setBaseColor("active"),s.changed())}}return e}#W(t){t&&this.#ut(t.digit)}#ut(t){this.#dt=t;for(const t of this.#N.sprites)t.activate(!0);this.#N.sprites[null!=t?t-1:9].activate(!1),this.#N.changed()}}class m{#y;#q;#At;#yt;#Z;#Rt;#Bt;#Tt;#nt;constructor(t,e){this.#y=t,this.#q=e,this.#At=6,this.#yt=5,this.#Z=new o(this.#y,100,100,this.#At,this.#yt,64,16,16,t=>this.#st(t));const i=this.#Z.sprites.slice();for(let t=1;t<=this.#At*this.#yt/2;t++){const e=Math.floor(Math.random()*i.length),s=i[e];i.splice(e,1);const r=Math.floor(Math.random()*i.length),h=i[r];i.splice(r,1),s.secret=t,h.secret=t}}update(){this.#Z.update()}draw(){this.#Z.draw()}#st(t){t&&!t.open&&(this.#Bt&&this.#Tt&&this.#Et(),t.open=!0,t.write(this.#y.text,t.secret,16,"highlight"),t.setBaseColor("active"),this.#Rt?(t.secret===this.#Rt.secret?(t.found=!0,t.activate(!1),this.#Rt.found=!0,this.#Rt.activate(!1),this.#Z.sprites.every(t=>t.found)&&this.#q&&this.#q()):(this.#Bt=this.#Rt,this.#Tt=t,this.#nt=this.#y.scheduleTimer(1e3,()=>this.#Et())),this.#Rt=!1):this.#Rt=t)}#Et(){(this.#nt||{}).disabled=!0,this.#Bt.open=!1,this.#Bt.content.enabled=!1,this.#Bt.setBaseColor("primary"),this.#Tt.open=!1,this.#Tt.content.enabled=!1,this.#Tt.setBaseColor("primary"),this.#Z.changed(),this.#y.text.changed(),this.#Bt=null,this.#Tt=null}}class u{#y;#q;#At;#yt;#Z;#St;constructor(t,e){this.#y=t,this.#q=e,this.#At=10,this.#yt=10,this.#Z=new o(this.#y,100,100,this.#At,this.#yt,32,0,0,t=>this.#st(t));for(let t=0;t<this.#At*this.#yt;t++){const e=this.#Z.sprites[t];e.index=t,e.write(this.#y.text,t,12,"highlight")}for(let t=0;t<this.#At*this.#yt/2;t++){const t=this.#Z.sprites[Math.floor(Math.random()*this.#Z.sprites.length)],e=this.#Z.sprites[Math.floor(Math.random()*this.#Z.sprites.length)];this.#kt(t,e)}this.#y.text.changed()}update(){this.#Z.update()}draw(){this.#Z.draw()}#st(t){t&&(this.#St?(this.#St.activate(!0),this.#kt(this.#St,t),this.#St=null,this.#gt()):(t.activate(!1),this.#St=t))}#kt(t,e){const i=t.index;t.index=e.index,e.index=i,t.write(this.#y.text,t.index,12,"highlight"),e.write(this.#y.text,e.index,12,"highlight")}#gt(){for(let t=0;t<this.#At*this.#yt;t++)if(this.#Z.sprites[t].index!==t)return;this.#Z.disabled=!0,this.#q&&this.#q()}}class p{#y;#N;#Ct;constructor(t){this.#y=t,this.#N=new o(this.#y,100,100,3,3,64,32,32,t=>this.#W(t)),this.#N.sprites[0].minigame=c,this.#N.sprites[1].minigame=g,this.#N.sprites[2].minigame=m,this.#N.sprites[3].minigame=d,this.#N.sprites[4].minigame=u,this.#N.sprites[5].activate(!1),this.#N.sprites[6].activate(!1),this.#N.sprites[7].activate(!1),this.#N.sprites[8].activate(!1)}update(){return this.#Ct?this.#Ct:(this.#N.update(),this)}draw(){this.#N.draw()}#W(t){t&&(this.#Ct=new l(this.#y,t.minigame))}}const f=new class{#Pt;#Lt;#Xt;#Mt;constructor(){this.renderer=new i,this.input=new s(this),this.#Pt=[],this.text=new n(this),this.#Lt=new h(this,"textures/sprites.png",16),this.#Xt=this.#Lt.addSprite(0,0,26,0,"blackcat"),this.#Mt=new p(this)}step(t){this.timestamp=t,this.#Ut(t),this.#Gt()}scheduleTimer(t,e,i){const s={start:this.timestamp??0,delay:t,onexpire:e,repeat:i};return this.#Pt.push(s),s}#Ut(t){this.input.update(),this.input.moved&&(this.#Xt.x=this.input.x-6,this.#Xt.y=this.input.y-6,this.#Lt.changed()),this.#_t(t),this.#Mt=this.#Mt.update(),this.text.update(),this.#Lt.update()}#_t(t){for(const e of this.#Pt)t>=e.start+e.delay&&!e.disabled&&(e.repeat?e.start=t:e.expired=!0,e.onexpire&&e.onexpire());this.#Pt.some(t=>t.expired||t.disabled)&&(this.#Pt=this.#Pt.filter(t=>!t.expired&&!t.disabled))}#Gt(){this.renderer.clear(),this.#Mt.draw(),this.text.draw(),this.#Lt.draw()}};requestAnimationFrame(function t(e){requestAnimationFrame(t),f.step(e)})}();
//# sourceMappingURL=bundle.js.map
